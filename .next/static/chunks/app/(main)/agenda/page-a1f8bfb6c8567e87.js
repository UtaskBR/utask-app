(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9180],{599:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>m});var t=a(5155),r=a(2115),l=a(2108),n=a(6874),i=a.n(n),d=a(6766),c=a(3568),o=a(7471);function m(){let{data:e}=(0,l.useSession)(),[s,a]=(0,r.useState)([]),[n,d]=(0,r.useState)(!0),[m,h]=(0,r.useState)("calendar"),[u,g]=(0,r.useState)(null),[p,v]=(0,r.useState)([]),[j,f]=(0,r.useState)(!1),[N,b]=(0,r.useState)(null),[y,w]=(0,r.useState)({x:0,y:0});(0,r.useEffect)(()=>{var s;(null==e||null==(s=e.user)?void 0:s.id)&&D()},[e]);let D=async()=>{try{var s;d(!0);let t=await fetch("/api/users/".concat(null==e||null==(s=e.user)?void 0:s.id,"/appointments"));if(t.ok){let e=(await t.json()).filter(e=>"IN_PROGRESS"===e.status);a(e);let s=e.filter(e=>e.date).map(e=>new Date(e.date));v(s)}else c.oR.error("Erro ao carregar compromissos")}catch(e){console.error("Erro ao buscar compromissos:",e),c.oR.error("Erro ao carregar compromissos")}finally{d(!1)}},C=u?s.filter(e=>{if(!e.date)return!1;let s=new Date(e.date);return s.getDate()===u.getDate()&&s.getMonth()===u.getMonth()&&s.getFullYear()===u.getFullYear()}):s,S=new Date,E=s.filter(e=>!!e.date&&new Date(e.date)>=S),A=s.filter(e=>!!e.date&&new Date(e.date)<S);return e?(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Minha Agenda"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6",children:[(0,t.jsx)("button",{onClick:()=>h("calendar"),className:"px-4 py-2 rounded-md ".concat("calendar"===m?"bg-primary-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Calend\xe1rio"}),(0,t.jsxs)("button",{onClick:()=>h("upcoming"),className:"px-4 py-2 rounded-md ".concat("upcoming"===m?"bg-primary-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["Pr\xf3ximos (",E.length,")"]}),(0,t.jsxs)("button",{onClick:()=>h("past"),className:"px-4 py-2 rounded-md ".concat("past"===m?"bg-primary-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["Passados (",A.length,")"]})]}),n?(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})}):(0,t.jsxs)("div",{children:["calendar"===m&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("div",{className:"calendar-container mb-6",children:(0,t.jsx)(o.Ay,{onChange:e=>{e instanceof Date?g(e):Array.isArray(e)&&e.length>0&&e[0]instanceof Date?g(e[0]):g(null)},value:u,tileContent:e=>{let{date:s,view:a}=e;return"month"===a&&p.some(e=>e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear())?(0,t.jsx)("div",{className:"h-2 w-2 bg-primary-500 rounded-full mx-auto mt-1"}):null},className:"rounded-lg shadow-md border border-gray-200 p-4 w-full"})}),u&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Servi\xe7os em ",u.toLocaleDateString("pt-BR"),(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",C.length,")"]})]}),0===C.length?(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,t.jsx)("p",{className:"text-gray-700",children:"Nenhum servi\xe7o agendado para esta data."})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(s=>{var a;return(0,t.jsx)(x,{service:s,userId:null==e||null==(a=e.user)?void 0:a.id},s.id)})})]})]}),"upcoming"===m&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Pr\xf3ximos servi\xe7os",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",E.length,")"]})]}),0===E.length?(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,t.jsx)("p",{className:"text-gray-700",children:"Voc\xea n\xe3o tem servi\xe7os agendados."})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(s=>{var a;return(0,t.jsx)(x,{service:s,userId:null==e||null==(a=e.user)?void 0:a.id},s.id)})})]}),"past"===m&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Servi\xe7os passados",(0,t.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",A.length,")"]})]}),0===A.length?(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,t.jsx)("p",{className:"text-gray-700",children:"Voc\xea n\xe3o tem servi\xe7os passados."})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(s=>{var a;return(0,t.jsx)(x,{service:s,userId:null==e||null==(a=e.user)?void 0:a.id},s.id)})})]})]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[60vh]",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Acesso Restrito"}),(0,t.jsx)("p",{className:"mb-6",children:"Fa\xe7a login para acessar sua agenda de servi\xe7os."}),(0,t.jsx)(i(),{href:"/login",className:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors",children:"Fazer Login"})]})}function x(e){var s,a,r,l,n,c,o,m,x,h,u;let g,{service:p,userId:v}=e,j=p.creatorId===v;null==(s=p.bids)||s.some(e=>e.providerId===v&&"ACCEPTED"===e.status);let f=null==(a=p.bids)?void 0:a.find(e=>"ACCEPTED"===e.status);return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:p.title})}),(0,t.jsx)("p",{className:"text-gray-700 text-sm mb-4 line-clamp-2",children:p.description}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Valor:"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:null==(g=f?f.value:p.value)?"A combinar":"R$ ".concat(g.toFixed(2).replace(".",","))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Data:"}),(0,t.jsx)("p",{className:"text-sm font-medium",children:(u=p.date)?new Date(u).toLocaleDateString("pt-BR"):"A combinar"})]})]}),j?(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Prestador:"}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)("div",{className:"h-6 w-6 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mr-2",children:(null==f||null==(r=f.provider)?void 0:r.image)?(0,t.jsx)(d.default,{src:f.provider.image,alt:f.provider.name||"Prestador",width:24,height:24,className:"h-6 w-6 rounded-full"}):(0,t.jsx)("span",{className:"text-xs text-gray-700 font-medium",children:(null==f||null==(n=f.provider)||null==(l=n.name)?void 0:l.charAt(0))||"P"})}),(0,t.jsx)("span",{className:"text-sm font-medium",children:(null==f||null==(c=f.provider)?void 0:c.name)||"Prestador n\xe3o dispon\xedvel"})]})]}):(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Cliente:"}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)("div",{className:"h-6 w-6 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mr-2",children:(null==(o=p.creator)?void 0:o.image)?(0,t.jsx)(d.default,{src:p.creator.image,alt:p.creator.name||"Cliente",width:24,height:24,className:"h-6 w-6 rounded-full"}):(0,t.jsx)("span",{className:"text-xs text-gray-700 font-medium",children:(null==(x=p.creator)||null==(m=x.name)?void 0:m.charAt(0))||"C"})}),(0,t.jsx)("span",{className:"text-sm font-medium",children:(null==(h=p.creator)?void 0:h.name)||"Cliente n\xe3o dispon\xedvel"})]})]}),(0,t.jsx)(i(),{href:"/servicos/".concat(p.id),className:"w-full block text-center py-2 px-4 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-md transition-colors",children:"Ver detalhes"})]})})}a(6769)},5428:(e,s,a)=>{Promise.resolve().then(a.bind(a,599))}},e=>{var s=s=>e(e.s=s);e.O(0,[1e3,2108,6874,3568,6766,1551,8441,1684,7358],()=>s(5428)),_N_E=e.O()}]);