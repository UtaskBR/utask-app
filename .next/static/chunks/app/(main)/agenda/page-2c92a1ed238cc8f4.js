(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9180],{599:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var a=s(5155),r=s(2115),l=s(2108),n=s(6874),i=s.n(n),d=s(6766),c=s(3568),o=s(7471);function m(){var e,t;let{data:s}=(0,l.useSession)(),[n,d]=(0,r.useState)([]),[m,u]=(0,r.useState)(!0),[h,g]=(0,r.useState)("calendar"),[p,v]=(0,r.useState)(null),[j,f]=(0,r.useState)([]),[b,N]=(0,r.useState)(!1),[y,w]=(0,r.useState)(null),[D,C]=(0,r.useState)({x:0,y:0});(0,r.useEffect)(()=>{var e;(null==s||null==(e=s.user)?void 0:e.id)&&S()},[s]);let S=async()=>{try{u(!0);let e=await fetch("/api/users/".concat(s.user.id,"/appointments"));if(e.ok){let t=(await e.json()).filter(e=>"IN_PROGRESS"===e.status);d(t);let s=t.filter(e=>e.date).map(e=>new Date(e.date));f(s)}else c.oR.error("Erro ao carregar agenda")}catch(e){console.error("Erro:",e),c.oR.error("Erro ao carregar agenda")}finally{u(!1)}},E=p?n.filter(e=>{if(!e.date)return!1;let t=new Date(e.date);return t.getDate()===p.getDate()&&t.getMonth()===p.getMonth()&&t.getFullYear()===p.getFullYear()}):n,k=new Date;k.setHours(0,0,0,0);let P=n.filter(e=>{if(!e.date)return!1;let t=new Date(e.date);return t.setHours(0,0,0,0),t>=k}),A=n.filter(e=>{if(!e.date)return!1;let t=new Date(e.date);return t.setHours(0,0,0,0),t<k}),R=e=>j.some(t=>t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()),F=(e,t)=>{w(e),C({x:t.clientX,y:t.clientY}),N(!0)},M=()=>{N(!1),w(null)};return m?(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Agenda"}),(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})})]}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Agenda"}),(0,a.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,a.jsxs)("ul",{className:"flex flex-wrap -mb-px",children:[(0,a.jsx)("li",{className:"mr-2",children:(0,a.jsx)("button",{className:"inline-block py-2 px-4 text-sm font-medium ".concat("calendar"===h?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"),onClick:()=>{g("calendar"),v(null)},children:"Calend\xe1rio"})}),(0,a.jsx)("li",{className:"mr-2",children:(0,a.jsxs)("button",{className:"inline-block py-2 px-4 text-sm font-medium ".concat("upcoming"===h?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"),onClick:()=>{g("upcoming"),v(null)},children:["Pr\xf3ximos (",P.length,")"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("button",{className:"inline-block py-2 px-4 text-sm font-medium ".concat("past"===h?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"),onClick:()=>{g("past"),v(null)},children:["Passados (",A.length,")"]})})]})}),"calendar"===h&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(o.Ay,{onChange:v,value:p,className:"rounded-lg shadow-md border border-gray-200 p-4 w-full max-w-3xl mx-auto",tileClassName:e=>{let{date:t}=e;return R(t)?"bg-primary-100 text-primary-800 font-bold rounded-full":null},tileContent:e=>{let{date:t}=e;if(R(t)){let e=n.filter(e=>{if(!e.date)return!1;let s=new Date(e.date);return s.getDate()===t.getDate()&&s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()});return(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 flex justify-center",onMouseEnter:t=>F(e[0],t),onMouseLeave:M,children:(0,a.jsx)("span",{className:"h-1.5 w-1.5 bg-primary-500 rounded-full"})})}return null}})}),b&&y&&(0,a.jsxs)("div",{className:"fixed bg-white rounded-lg shadow-lg p-4 z-50 w-64",style:{top:"".concat(D.y+10,"px"),left:"".concat(D.x+10,"px")},children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:y.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:(e=y.date)?new Date(e).toLocaleDateString("pt-BR"):"A combinar"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:null==(t=y.value)?"A combinar":"R$ ".concat(t.toFixed(2).replace(".",","))}),y.client&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Cliente: ",y.client.name]}),y.provider&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Prestador: ",y.provider.name]})]}),p&&(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Servi\xe7os em ",p.toLocaleDateString("pt-BR"),(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",E.length,")"]})]}),0===E.length?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,a.jsx)("p",{className:"text-gray-700",children:"N\xe3o h\xe1 servi\xe7os agendados para esta data."})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(e=>{var t;return(0,a.jsx)(x,{service:e,userId:null==s||null==(t=s.user)?void 0:t.id},e.id)})})]})]}),"upcoming"===h&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Pr\xf3ximos servi\xe7os",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",P.length,")"]})]}),0===P.length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Voc\xea n\xe3o tem servi\xe7os agendados."}),(0,a.jsx)(i(),{href:"/explorar",className:"btn-primary",children:"Explorar servi\xe7os dispon\xedveis"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(e=>{var t;return(0,a.jsx)(x,{service:e,userId:null==s||null==(t=s.user)?void 0:t.id},e.id)})})]}),"past"===h&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Servi\xe7os passados",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",A.length,")"]})]}),0===A.length?(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,a.jsx)("p",{className:"text-gray-700",children:"Voc\xea n\xe3o tem servi\xe7os passados."})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(e=>{var t;return(0,a.jsx)(x,{service:e,userId:null==s||null==(t=s.user)?void 0:t.id},e.id)})})]})]})}function x(e){var t,s,r,l,n,c,o,m,x,u,h;let g,{service:p,userId:v}=e,j=p.creatorId===v;null==(t=p.bids)||t.some(e=>e.providerId===v&&"ACCEPTED"===e.status);let f=null==(s=p.bids)?void 0:s.find(e=>"ACCEPTED"===e.status);return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:p.title})}),(0,a.jsx)("p",{className:"text-gray-700 text-sm mb-4 line-clamp-2",children:p.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Valor:"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:null==(g=f?f.value:p.value)?"A combinar":"R$ ".concat(g.toFixed(2).replace(".",","))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Data:"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:(h=p.date)?new Date(h).toLocaleDateString("pt-BR"):"A combinar"})]})]}),j?(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Prestador:"}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)("div",{className:"h-6 w-6 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mr-2",children:(null==f||null==(r=f.provider)?void 0:r.image)?(0,a.jsx)(d.default,{src:f.provider.image,alt:f.provider.name||"Prestador",width:24,height:24,className:"h-6 w-6 rounded-full"}):(0,a.jsx)("span",{className:"text-xs text-gray-700 font-medium",children:(null==f||null==(n=f.provider)||null==(l=n.name)?void 0:l.charAt(0))||"P"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(null==f||null==(c=f.provider)?void 0:c.name)||"Prestador n\xe3o dispon\xedvel"})]})]}):(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Cliente:"}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)("div",{className:"h-6 w-6 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mr-2",children:(null==(o=p.creator)?void 0:o.image)?(0,a.jsx)(d.default,{src:p.creator.image,alt:p.creator.name||"Cliente",width:24,height:24,className:"h-6 w-6 rounded-full"}):(0,a.jsx)("span",{className:"text-xs text-gray-700 font-medium",children:(null==(x=p.creator)||null==(m=x.name)?void 0:m.charAt(0))||"C"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(null==(u=p.creator)?void 0:u.name)||"Cliente n\xe3o dispon\xedvel"})]})]}),(0,a.jsx)(i(),{href:"/servicos/".concat(p.id),className:"w-full block text-center py-2 px-4 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-md transition-colors",children:"Ver detalhes"})]})})}s(6769)},5428:(e,t,s)=>{Promise.resolve().then(s.bind(s,599))}},e=>{var t=t=>e(e.s=t);e.O(0,[1e3,2108,6874,3568,6766,1551,8441,1684,7358],()=>t(5428)),_N_E=e.O()}]);