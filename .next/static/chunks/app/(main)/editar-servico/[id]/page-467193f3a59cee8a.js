(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3571],{498:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>c});var s=r(5155),t=r(2115),o=r(5695),i=r(2108),l=r(6874),d=r.n(l),n=r(3568);function c(e){let{params:a}=e,r=(0,o.useRouter)(),{data:l,status:c}=(0,i.useSession)(),[m,u]=(0,t.useState)(!0),[p,h]=(0,t.useState)(!1),[x,v]=(0,t.useState)(""),[f,j]=(0,t.useState)([]),[b,g]=(0,t.useState)({title:"",description:"",date:"",timeWindow:60,value:"",professionId:"",latitude:null,longitude:null,address:""});(0,t.useEffect)(()=>{"unauthenticated"===c&&r.push("/auth/login"),"authenticated"===c&&a.id&&(y(),N())},[c,a.id,r]);let y=async()=>{try{var e;u(!0);let r=await fetch("/api/services/".concat(a.id));if(!r.ok)throw Error("Erro ao carregar detalhes do servi\xe7o");let s=await r.json();if((null==l||null==(e=l.user)?void 0:e.id)!==s.creatorId)return void v("Voc\xea n\xe3o tem permiss\xe3o para editar este servi\xe7o");if("OPEN"!==s.status)return void v("Este servi\xe7o n\xe3o pode ser editado porque j\xe1 foi aceito ou est\xe1 em andamento");let t="";s.date&&(t=new Date(s.date).toISOString().slice(0,16)),g({title:s.title,description:s.description,date:t,timeWindow:s.timeWindow||60,value:s.value?s.value.toString():"",professionId:s.professionId||"",latitude:s.latitude,longitude:s.longitude,address:s.address||""})}catch(e){console.error("Erro ao carregar servi\xe7o:",e),n.oR.error("Erro ao carregar detalhes do servi\xe7o")}finally{u(!1)}},N=async()=>{try{let e=await fetch("/api/professions");if(!e.ok)throw Error("Erro ao carregar profiss\xf5es");let a=await e.json();j(a)}catch(e){console.error("Erro ao carregar profiss\xf5es:",e),n.oR.error("Erro ao carregar categorias de servi\xe7o")}},w=e=>{let{name:a,value:r}=e.target;g(e=>({...e,[a]:r}))},E=async e=>{e.preventDefault();try{h(!0);let e={...b,value:b.value?parseFloat(b.value):null,timeWindow:parseInt(b.timeWindow.toString()),professionId:b.professionId||null},s=await fetch("/api/services/".concat(a.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){let e=await s.json();throw Error(e.error||"Erro ao atualizar servi\xe7o")}n.oR.success("Servi\xe7o atualizado com sucesso!"),r.push("/meus-servicos")}catch(e){console.error("Erro ao atualizar servi\xe7o:",e),n.oR.error(e.message||"Erro ao atualizar servi\xe7o")}finally{h(!1)}};return m?(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})})}):x?(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-red-700 mb-2",children:"Erro"}),(0,s.jsx)("p",{className:"text-red-600 mb-4",children:x}),(0,s.jsx)(d(),{href:"/meus-servicos",className:"inline-block py-2 px-4 bg-primary-500 hover:bg-primary-600 text-white font-medium rounded-md transition-colors",children:"Voltar para Meus Servi\xe7os"})]})}):(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Editar Servi\xe7o"}),(0,s.jsx)("form",{onSubmit:E,className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-secondary-700",children:"T\xedtulo *"}),(0,s.jsx)("input",{id:"title",name:"title",type:"text",required:!0,className:"input-field mt-1",placeholder:"Ex: Instala\xe7\xe3o de Ar Condicionado",value:b.title,onChange:w})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-secondary-700",children:"Descri\xe7\xe3o *"}),(0,s.jsx)("textarea",{id:"description",name:"description",rows:4,required:!0,className:"input-field mt-1",placeholder:"Descreva detalhadamente o servi\xe7o que voc\xea precisa",value:b.description,onChange:w})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"professionId",className:"block text-sm font-medium text-secondary-700",children:"Tipo de Servi\xe7o"}),(0,s.jsxs)("select",{id:"professionId",name:"professionId",className:"input-field mt-1",value:b.professionId,onChange:w,children:[(0,s.jsx)("option",{value:"",children:"Selecione uma categoria"}),f.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"value",className:"block text-sm font-medium text-secondary-700",children:"Valor (R$)"}),(0,s.jsx)("input",{id:"value",name:"value",type:"number",step:"0.01",min:"0",className:"input-field mt-1",placeholder:"Deixe em branco para receber propostas",value:b.value,onChange:w}),(0,s.jsx)("p",{className:"mt-1 text-xs text-secondary-500",children:"Deixe em branco para receber propostas de valor dos prestadores"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-secondary-700",children:"Data e Hora"}),(0,s.jsx)("input",{id:"date",name:"date",type:"datetime-local",className:"input-field mt-1",value:b.date,onChange:w})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"timeWindow",className:"block text-sm font-medium text-secondary-700",children:"Janela de Tempo (minutos)"}),(0,s.jsxs)("select",{id:"timeWindow",name:"timeWindow",className:"input-field mt-1",value:b.timeWindow,onChange:w,children:[(0,s.jsx)("option",{value:"30",children:"30 minutos"}),(0,s.jsx)("option",{value:"60",children:"1 hora"}),(0,s.jsx)("option",{value:"120",children:"2 horas"}),(0,s.jsx)("option",{value:"180",children:"3 horas"}),(0,s.jsx)("option",{value:"240",children:"4 horas"})]}),(0,s.jsx)("p",{className:"mt-1 text-xs text-secondary-500",children:"Flexibilidade de hor\xe1rio para a realiza\xe7\xe3o do servi\xe7o"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-secondary-700",children:"Endere\xe7o"}),(0,s.jsx)("input",{id:"address",name:"address",type:"text",className:"input-field mt-1",placeholder:"Endere\xe7o completo onde o servi\xe7o ser\xe1 realizado",value:b.address,onChange:w}),(0,s.jsx)("p",{className:"mt-1 text-xs text-secondary-500",children:"Deixe em branco para servi\xe7os remotos"})]}),(0,s.jsxs)("div",{className:"pt-4 flex space-x-3",children:[(0,s.jsx)(d(),{href:"/meus-servicos",className:"flex-1 py-3 px-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-md transition-colors text-center",children:"Cancelar"}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"flex-1 btn-primary py-3 flex justify-center items-center",children:p?"Salvando...":"Salvar Altera\xe7\xf5es"})]})]})})]})}},3312:(e,a,r)=>{Promise.resolve().then(r.bind(r,498))},5695:(e,a,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(a,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(a,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(a,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(a,{useSearchParams:function(){return s.useSearchParams}})}},e=>{var a=a=>e(e.s=a);e.O(0,[2108,6874,3568,8441,1684,7358],()=>a(3312)),_N_E=e.O()}]);