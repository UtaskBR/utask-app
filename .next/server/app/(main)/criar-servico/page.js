(()=>{var e={};e.id=6427,e.ids=[6427],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19755:(e,r,s)=>{Promise.resolve().then(s.bind(s,66300))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66300:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Ol\xe1\\\\Documents\\\\UTASK\\\\app\\\\(main)\\\\criar-servico\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Ol\xe1\\Documents\\UTASK\\app\\(main)\\criar-servico\\page.tsx","default")},66479:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d});var t=s(65239),o=s(48088),a=s(88170),i=s.n(a),n=s(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);s.d(r,l);let d={children:["",{children:["(main)",{children:["criar-servico",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,66300)),"C:\\Users\\Ol\xe1\\Documents\\UTASK\\app\\(main)\\criar-servico\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,19559)),"C:\\Users\\Ol\xe1\\Documents\\UTASK\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"C:\\Users\\Ol\xe1\\Documents\\UTASK\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\Ol\xe1\\Documents\\UTASK\\app\\(main)\\criar-servico\\page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:o.RouteKind.APP_PAGE,page:"/(main)/criar-servico/page",pathname:"/criar-servico",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},68974:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>d});var t=s(60687),o=s(43210),a=s(82136),i=s(30474),n=s(16189),l=s(37590);function d(){let{data:e,status:r}=(0,a.useSession)(),s=(0,n.useRouter)(),[d,c]=(0,o.useState)(!1),[m,p]=(0,o.useState)([]),[u,x]=(0,o.useState)(""),[h,v]=(0,o.useState)([]),[f,j]=(0,o.useState)([]),b=(0,o.useRef)(null),[g,y]=(0,o.useState)({title:"",description:"",date:"",timeWindow:60,value:"",professionId:"",latitude:null,longitude:null,address:""}),N=e=>{let{name:r,value:s}=e.target;y(e=>({...e,[r]:s}))},w=e=>{let r=[...h],s=[...f];URL.revokeObjectURL(s[e]),r.splice(e,1),s.splice(e,1),v(r),j(s)},C=async e=>{try{let r=new FormData;h.forEach(e=>{r.append("photos",e)}),r.append("serviceId",e),console.log("Enviando fotos para o servi\xe7o:",e);let s=await fetch("/api/photos",{method:"POST",body:r});if(!s.ok){if(404===s.status)throw Error("API de fotos n\xe3o encontrada. Verifique se o endpoint est\xe1 correto.");let e=await s.text(),r="Erro desconhecido ao fazer upload das fotos";try{r=JSON.parse(e).error||r}catch(t){r=e.includes("<!DOCTYPE html>")?`Erro no servidor: ${s.status} ${s.statusText}`:e||r}throw Error(r)}let t=await s.text();if(!t.trim())return console.log("Resposta vazia do servidor"),{photos:[]};try{let e=JSON.parse(t);return console.log("Fotos enviadas com sucesso:",e),e}catch(e){throw console.error("Erro ao analisar resposta JSON:",e),console.error("Resposta recebida:",t),Error("Erro ao processar resposta do servidor")}}catch(e){throw console.error("Exce\xe7\xe3o ao fazer upload de fotos:",e),e}},S=async e=>{if(e.preventDefault(),x(""),!g.title||!g.description)return void x("T\xedtulo e descri\xe7\xe3o s\xe3o obrigat\xf3rios");c(!0);try{let e=await fetch("/api/services",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...g,value:g.value?parseFloat(g.value):null,timeWindow:g.timeWindow?parseInt(g.timeWindow):null})});if(!e.ok){let r=await e.json();throw Error(r.error||"Erro ao criar servi\xe7o")}let r=(await e.json()).id;if(h.length>0)try{await C(r),l.oR.success("Servi\xe7o criado com sucesso com fotos!")}catch(e){console.error("Exce\xe7\xe3o ao fazer upload de fotos:",e),l.oR.error(`Servi\xe7o criado, mas erro no upload de fotos: ${e.message}`),await new Promise(e=>setTimeout(e,2e3))}else l.oR.success("Servi\xe7o criado com sucesso!");s.push(`/servicos/${r}`)}catch(e){console.error("Erro ao criar servi\xe7o:",e),x(e.message),c(!1)}};return"loading"===r?(0,t.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,t.jsx)("p",{children:"Carregando..."})}):(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-secondary-900",children:"Criar Novo Servi\xe7o"}),(0,t.jsx)("p",{className:"mt-2 text-secondary-600",children:"Preencha os detalhes do servi\xe7o que voc\xea precisa"})]}),u&&(0,t.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-6",children:(0,t.jsx)("p",{className:"text-sm text-red-700",children:u})}),(0,t.jsx)("form",{onSubmit:S,className:"bg-white shadow-md rounded-lg p-6",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-secondary-700",children:"T\xedtulo do Servi\xe7o *"}),(0,t.jsx)("input",{id:"title",name:"title",type:"text",required:!0,className:"input-field mt-1",placeholder:"Ex: Instala\xe7\xe3o de Ar Condicionado",value:g.title,onChange:N})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-secondary-700",children:"Descri\xe7\xe3o *"}),(0,t.jsx)("textarea",{id:"description",name:"description",rows:4,required:!0,className:"input-field mt-1",placeholder:"Descreva detalhadamente o servi\xe7o que voc\xea precisa",value:g.description,onChange:N})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700",children:"Fotos do Servi\xe7o"}),(0,t.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",ref:b,onChange:e=>{let r=Array.from(e.target.files);if(0===r.length)return;if(h.length+r.length>5)return void l.oR.error("Voc\xea pode adicionar no m\xe1ximo 5 fotos");v(e=>[...e,...r]);let s=r.map(e=>URL.createObjectURL(e));j(e=>[...e,...s])}}),(0,t.jsx)("button",{type:"button",onClick:()=>b.current.click(),className:"btn-outline py-2 px-4",children:"Adicionar Fotos"}),(0,t.jsx)("span",{className:"ml-3 text-xs text-secondary-500",children:"M\xe1ximo de 5 fotos"})]}),f.length>0&&(0,t.jsx)("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4",children:f.map((e,r)=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"h-24 w-full rounded-md overflow-hidden",children:(0,t.jsx)(i.default,{src:e,alt:`Foto ${r+1}`,fill:!0,style:{objectFit:"cover"}})}),(0,t.jsx)("button",{type:"button",onClick:()=>w(r),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-md",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},r))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"professionId",className:"block text-sm font-medium text-secondary-700",children:"Tipo de Servi\xe7o"}),(0,t.jsxs)("select",{id:"professionId",name:"professionId",className:"input-field mt-1",value:g.professionId,onChange:N,children:[(0,t.jsx)("option",{value:"",children:"Selecione uma categoria"}),m.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"value",className:"block text-sm font-medium text-secondary-700",children:"Valor (R$)"}),(0,t.jsx)("input",{id:"value",name:"value",type:"number",step:"0.01",min:"0",className:"input-field mt-1",placeholder:"Deixe em branco para receber propostas",value:g.value,onChange:N}),(0,t.jsx)("p",{className:"mt-1 text-xs text-secondary-500",children:"Deixe em branco para receber propostas de valor dos prestadores"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-secondary-700",children:"Data e Hora"}),(0,t.jsx)("input",{id:"date",name:"date",type:"datetime-local",className:"input-field mt-1",value:g.date,onChange:N})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"timeWindow",className:"block text-sm font-medium text-secondary-700",children:"Janela de Tempo (minutos)"}),(0,t.jsxs)("select",{id:"timeWindow",name:"timeWindow",className:"input-field mt-1",value:g.timeWindow,onChange:N,children:[(0,t.jsx)("option",{value:"30",children:"30 minutos"}),(0,t.jsx)("option",{value:"60",children:"1 hora"}),(0,t.jsx)("option",{value:"120",children:"2 horas"}),(0,t.jsx)("option",{value:"180",children:"3 horas"}),(0,t.jsx)("option",{value:"240",children:"4 horas"})]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-secondary-500",children:"Flexibilidade de hor\xe1rio para a realiza\xe7\xe3o do servi\xe7o"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-secondary-700",children:"Endere\xe7o"}),(0,t.jsx)("input",{id:"address",name:"address",type:"text",className:"input-field mt-1",placeholder:"Endere\xe7o completo onde o servi\xe7o ser\xe1 realizado",value:g.address,onChange:N}),(0,t.jsx)("p",{className:"mt-1 text-xs text-secondary-500",children:"Deixe em branco para servi\xe7os remotos"})]}),(0,t.jsx)("div",{className:"pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:d,className:"w-full btn-primary py-3 flex justify-center items-center",children:d?"Processando...":"Criar Servi\xe7o"})})]})})]})}},95779:(e,r,s)=>{Promise.resolve().then(s.bind(s,68974))}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4243,6703,5418,474,9718],()=>s(66479));module.exports=t})();